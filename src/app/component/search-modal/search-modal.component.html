<ng-template #content let-modal>
	<div class="modal-header bg-primary">
		<form class="w-100" [formGroup]="searchForm">
            <input type="text" placeholder="search the docs..." class="form-control" formControlName="term" (input)="handleSearch()" #sf />
        </form>
	</div>
	<div class="modal-body">
        @if (!searchForm.get('term')?.value.length) {
            <div class="d-flex flex-row align-items-center mb-2">
                <span class="theme-icon-holder me-2">
                    <i class="fa-solid fa-xl fa-clock-rotate-left"></i>
                </span>
                <h5 class="mb-0 my-shadow">Search History</h5>
                @if (recentSearches.length && !results.length) {
                    <button class="ms-auto btn btn-link" (click)="removeHistoryItem()">clear</button>
                }
            </div>
            @if (recentSearches.length) {
                <div class="list-group">
                    @for (item of recentSearches; track $index) {
                        @if ($index < searchCompactLength || showAllHistory) {
                            <button href="#" class="list-group-item list-group-item-action d-flex flex-row justify-content-between" (click)="searchRecent(item)">
                                <span>{{ item }}</span>
                                <button type="button" class="btn-close" aria-label="Close" (click)="removeHistoryItem(item)"></button>
                            </button>
                        }
                    }
                </div>
                @if (recentSearches.length > searchCompactLength) {
                    <p class="mb-0 mt-3 text-center">
                        <button type="button" class="btn btn-link" (click)="setShowAllHistory(!showAllHistory)">
                            {{ showAllHistory ? 'Show less' : 'Show ' + (recentSearches.length - searchCompactLength) + ' more' }}
                        </button>
                    </p>
                }
            } @else {
                <p class="mb-0">Your search history is empty!</p>
            }
        } @else {
            @for (topic of results; track $index) {
                <div class="d-flex flex-row align-items-center mb-2">
                    <span class="theme-icon-holder me-2">
                        <i class="fa-solid fa-xl {{ topic.icon }}"></i>
                    </span>
                    <h5 class="mb-0" [innerHTML]="topic.title | emphasize: searchForm.get('term')?.value"></h5>
                </div>
                <div class="list-group {{ !$last ? 'mb-4' : '' }}">
                    @for (section of topic.sections; track section.id) {
                        <a routerLink="/documentation" [fragment]="section.slug" class="list-group-item list-group-item-action" aria-current="true" (click)="close()">
                            <small [innerHTML]="section.title | emphasize: searchForm.get('term')?.value"></small>
                        </a>
                    }
                </div>
            } @empty {
                <div class="text-center">
                    <i class="fa-solid text-primary fa-ban fa-fw me-2"></i> There are no results!
                </div>
            }
        }
	</div>
	<div class="modal-footer d-flex flex-row justify-content-between align-items-center">
        <small>
            <kbd>esc</kbd> to close
        </small>
		<button type="button" class="btn btn-outline-dark" (click)="close()">Close</button>
	</div>
</ng-template>
